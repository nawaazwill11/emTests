<!DOCTYPE html>
<html>
  <head>
    <title>Remove Markers</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #floating-panel {
        position: absolute;
        top: 10px;
        left: 25%;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        text-align: center;
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }
    </style>
  </head>
  <body>
    <div id="floating-panel">
      <input onclick="clearMarkers();" type=button value="Hide Markers">
      <input onclick="showMarkers();" type=button value="Show All Markers">
      <input onclick="deleteMarkers();" type=button value="Delete Markers">
    </div>
    <div id="map"></div>
    <p>Click on the map to add markers.</p>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>

      var lat= '';
  var lng = '';
  var current_location = []
  $(document).ready(function getLocation() {
      if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
      } else { 
          alert('Unable to get location')
      }
  });

  function showPosition(position) {
      current_location = []
      lat = position.coords.latitude
      lng = position.coords.longitude
      //document.getElementById('inputs').innerHTML = lat+', '+lng 
      alert('loaded')
      initMap();
}
      var map;
      var markers = [];
      var latlng = {}
      
      var addressComponents = ''
      function initMap() {
        var haightAshbury = {lat: lat, lng: lng};

        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 12,
          center: haightAshbury,
          mapTypeId: 'roadmap'
        });
        var geocoder = new google.maps.Geocoder;
        var infowindow = new google.maps.InfoWindow;
        // This event listener will call addMarker() when the map is clicked.
        map.addListener('click', function(event) {
          deleteMarkers();

          addMarker(event.latLng, geocoder, infowindow);
        });

        // Adds a marker at the center of the map.
        //addMarker(haightAshbury);
      }

      // Adds a marker to the map and push to the array.
      function addMarker(location, geocoder, infowindow) {
        var marker = new google.maps.Marker({
          position: location,
          map: map
        });

        markers.push(marker);
        latlng = {lat: marker.getPosition().lat(), lng: marker.getPosition().lng()}
        geocoder.geocode({'location': latlng}, function(result, status){
          if (status === 'OK'){
            if (result[0]){

              addressComponents = result[0].address_components
              console.log(addressComponents)
              proveHasDict();
              infowindow.setContent(result[0].formatted_address);
              infowindow.open(map, markers[0]);
            }
          }
        });
        alert(latlng['lat']+", "+latlng['lng'])

      }

      // Sets the map on all markers in the array.
      function setMapOnAll(map) {
        for (var i = 0; i < markers.length; i++) {
          markers[i].setMap(map);
        }
      }

      // Removes the markers from the map, but keeps them in the array.
      function clearMarkers() {
        setMapOnAll(null);
      }


      // Deletes all markers in the array by removing references to them.
      function deleteMarkers() {
        clearMarkers();
        markers = [];
      }
    </script>
    <script type="text/javascript">
      function proveHasDict(){
        addressDict = {}
        for (var i = 0; i < addressComponents.length; i++) {
          addressDict[addressComponents[i].types[0]] = addressComponents[i].long_name
        }
        for (var key in addressDict){
          //alert(addressDict[key])
        }
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCfbJVCovd1FJJgLQdIcolfFc1yljUsndo&callback=initMap">
    </script>
  </body>
</html>